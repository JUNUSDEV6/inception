# Variables pour d√©veloppement local
DOCKER_COMPOSE_FILE = srcs/docker-compose.dev.yml
DATA_PATH = ./data

# Colors
GREEN = \033[0;32m
YELLOW = \033[1;33m
NC = \033[0m

.PHONY: dev-setup dev-build dev-up dev-down dev-clean dev-logs dev-ps

dev-setup:
	@echo "$(YELLOW)Creating local data directories...$(NC)"
	@mkdir -p $(DATA_PATH)/wordpress
	@mkdir -p $(DATA_PATH)/mariadb
	@echo "$(GREEN)Local directories created!$(NC)"

dev-build: dev-setup
	@echo "$(YELLOW)Building for local development...$(NC)"
	@docker-compose -f $(DOCKER_COMPOSE_FILE) build
	@echo "$(GREEN)Local build completed!$(NC)"

dev-up: dev-build
	@echo "$(YELLOW)Starting local development...$(NC)"
	@docker-compose -f $(DOCKER_COMPOSE_FILE) up -d
	@echo "$(GREEN)Local services started!$(NC)"
	@echo "$(GREEN)Access: https://localhost.42.fr$(NC)"

dev-down:
	@echo "$(YELLOW)Stopping local services...$(NC)"
	@docker-compose -f $(DOCKER_COMPOSE_FILE) down
	@echo "$(GREEN)Local services stopped!$(NC)"

dev-logs:
	@docker-compose -f $(DOCKER_COMPOSE_FILE) logs -f

dev-ps:
	@docker-compose -f $(DOCKER_COMPOSE_FILE) ps

dev-clean: dev-down
	@echo "$(YELLOW)Cleaning local environment...$(NC)"
	@docker system prune -af
	@rm -rf $(DATA_PATH)
	@echo "$(GREEN)Local cleanup completed!$(NC)"

dev-help:
	@echo "$(GREEN)Available development targets:$(NC)"
	@echo "  dev-setup - Create local directories"
	@echo "  dev-build - Build for local development"
	@echo "  dev-up    - Start local development"
	@echo "  dev-down  - Stop local services"
	@echo "  dev-logs  - View local logs"
	@echo "  dev-ps    - Show local containers"
	@echo "  dev-clean - Clean local environment"